<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Teacher Courses</title>

	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">


	<link rel="stylesheet" th:href="@{/css/teacher-css/teacher-sidebar.css}">
	<style>
		/* ================= BASE ================= */
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: 'Poppins', sans-serif;
		}

		body {
			background: #f4f6f9;
			color: #1f1f2e;
		}

		/* ================= LAYOUT ================= */
		.main-content {
			margin-left: 260px;
			padding: 20px 30px;
			transition: margin-left 0.3s ease;
		}

		/* When sidebar is collapsed */
		body.sidebar-collapsed .main-content {
			margin-left: 10px;
		}

		.container {
			max-width: 1200px;
			margin: auto;
			padding: 20px;
		}

		/* ================= HEADER ================= */
		.page-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 25px;
		}

		.page-title {
			font-size: 26px;
			font-weight: 600;
		}

		.draft-badge {
			background: #fff3cd;
			color: #664d03;
			padding: 6px 14px;
			border-radius: 20px;
			font-size: 13px;
		}

		/* ================= STEPPER ================= */
		.stepper {
			display: flex;
			gap: 12px;
			margin-bottom: 25px;
		}

		.step {
			flex: 1;
			padding: 10px;
			background: #e9ecf3;
			border-radius: 8px;
			text-align: center;
			font-size: 14px;
			font-weight: 500;
		}

		.step.active {
			background: #1f1f2e;
			color: #fff;
		}

		/* ================= CARD ================= */
		.card {
			background: #ffffff;
			border-radius: 14px;
			padding: 24px;
			margin-bottom: 28px;
		}

		/* ================= FORM ================= */
		.form-group {
			margin-bottom: 18px;
		}

		.form-group label {
			font-weight: 500;
			display: block;
			margin-bottom: 6px;
		}

		.form-group input,
		.form-group textarea,
		.form-group select {
			width: 100%;
			padding: 12px;
			border-radius: 8px;
			border: 1px solid #ccc;
		}

		.form-group small {
			font-size: 12px;
			color: #777;
		}

		/* ================= BUTTONS ================= */
		.btn {
			padding: 10px 18px;
			border-radius: 8px;
			border: none;
			cursor: pointer;
			font-weight: 500;
		}

		.btn-primary {
			background: #1f1f2e;
			color: #ffffff;
		}

		.btn-outline {
			background: transparent;
			border: 1px solid #1f1f2e;
			color: #1f1f2e;
		}

		.btn-warning {
			background: #f6a623;
			color: #1f1f2e;
		}

		/* ================= THUMBNAIL ================= */
		.thumbnail-upload {
			display: flex;
			gap: 16px;
			align-items: center;
		}

		.thumbnail-preview {
			width: 280px;
			height: 160px;
			border-radius: 12px;
			border: 2px dashed #ccc;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			color: #777;
			cursor: pointer;
		}

		.thumbnail-preview i {
			font-size: 32px;
		}

		/* ================= CURRICULUM ================= */

		/* Module Card */
		.module {
			background: #ffffff;
			border-radius: 14px;
			border: 1px solid #e2e6ef;
			margin-bottom: 20px;
			overflow: hidden;
		}

		/* Module Header */
		.module-header {
			background: #f4f6f9;
			padding: 14px 16px;
			display: grid;
			grid-template-columns: 1fr auto;
			gap: 12px;
			align-items: center;
			border-bottom: 1px solid #e2e6ef;
		}

		.module-header input {
			width: 100%;
			padding: 10px;
			border-radius: 8px;
			border: 1px solid #cfd4dc;
			font-weight: 500;
		}

		.module-actions {
			display: flex;
			gap: 8px;
			white-space: nowrap;
		}

		/* Lessons Container */
		.lessons {
			padding: 12px 16px 16px;
			display: flex;
			flex-direction: column;
			gap: 12px;
		}

		/* ================= LESSON ================= */
		.lesson {
			background: #f8f9fb;
			border-radius: 12px;
			padding: 14px;
			border: 1px solid #e2e6ef;
			display: flex;
			flex-direction: column;
			gap: 10px;
		}

		/* Lesson Header */
		.lesson-header {
			display: grid;
			grid-template-columns: 1fr 140px 36px;
			gap: 10px;
			align-items: center;
		}

		.lesson-header input,
		.lesson-header select {
			padding: 8px 10px;
			border-radius: 8px;
			border: 1px solid #cfd4dc;
		}

		/* Lesson Content */
		.lesson-content {
			background: #ffffff;
			border-radius: 10px;
			padding: 12px;
			border: 1px solid #e2e6ef;
		}

		/* ================= QUIZ ================= */
		.quiz-question {
			background: #ffffff;
			border-radius: 10px;
			padding: 12px;
			border: 1px solid #e2e6ef;
			margin-top: 10px;
		}

		.quiz-options {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 8px;
		}

		.quiz-options input,
		.quiz-question select {
			width: 100%;
			padding: 8px;
			border-radius: 8px;
			border: 1px solid #cfd4dc;
		}

		/* ================= ACTION BAR ================= */
		.action-bar {
			display: flex;
			justify-content: space-between;
			margin-top: 30px;
		}

		/* ================= UTILITIES ================= */
		.hidden {
			display: none;
		}
	</style>
</head>

<body class="sidebar-collapsed">

	<!-- ===== SIDEBAR ===== -->
	<aside class="sidebar collapsed">
		<div class="sidebar-logo">
			<img th:src="@{/images/logo.png}" alt="EduPlatform Logo"> <span class="logo-text">EduPlatform</span>
		</div>


		<nav class="sidebar-menu">
			<a th:href="@{/teacher-dashboard}"><i class="bi bi-speedometer2"></i><span>Dashboard </span></a>
			<a th:href="@{/teacher-course}"><i class="bi bi-journal-text"></i><span>Course Management</span></a>
			<a th:href="@{/teacher-creates-course}" class="active"><i class="bi bi-journal-plus"></i><span>Create
					Course</span></a>
			<a th:href="@{/teacher-exams}"><i class="bi bi-pencil-square"></i><span>Exams
					& Quizzes</span></a> <a th:href="@{/teacher-students}"><i
					class="bi bi-people"></i><span>Students</span></a>
			<a th:href="@{/teacher-communication}"><i class="bi bi-chat-dots"></i><span>Communication</span></a>
			<a th:href="@{/teacher-feedback}"><i class="bi bi-star"></i><span>Feedback
					& Ratings</span></a> <a th:href="@{/teacher-profile}"><i
					class="bi bi-gear"></i><span>Profile</span></a>
			<a th:href="@{/logout}" class="logout"><i class="bi bi-box-arrow-right"></i><span>Logout</span></a>
		</nav>
	</aside>

	<!-- ===== MAIN CONTENT ===== -->
	<main class="main-content">
		<button class="sidebar-toggle" id="sidebarToggle">â˜°</button>
		<div class="container">
			<form th:action="@{/teacher-creates-course}" th:object="${course}" method="post">
				<!-- HEADER -->
				<div class="page-header">
					<div class="page-title">
						<h3 th:text="${course.courseId == null ? 'Create Course' : 'Edit Course'}"></h3>
						<span class="draft-badge" th:text="${course.status != null ? course.status : 'DRAFT'}"></span>
					</div>
					<!-- <span class="draft-badge"
					th:text="${course.status != null ? course.status : 'DRAFT'}">
				</span> -->
				</div>

				<!-- STEPPER -->
				<div class="stepper">
					<div class="step active">Basic Info</div>
					<div class="step">Pricing</div>
					<div class="step">Curriculum & Content</div>
					<div class="step">Publish</div>
				</div>

				<!-- BASIC INFO -->
				<div class="card">
					<h3>Course Details</h3>

					<div class="form-group">
						<label>Course Thumbnail</label>

						<div class="thumbnail-upload">
							<!-- Hidden file input -->
							<input type="file" id="thumbnailInput" accept="image/*" hidden>

							<!-- Clickable UI box -->
							<div class="thumbnail-preview" id="thumbnailPreview">
								<i class="bi bi-image"></i> <span>Upload thumbnail</span>
							</div>
						</div>

						<small> Recommended size: 1280 Ã— 720 (16:9). JPG or PNG. </small>
					</div>

					<input type="hidden" th:field="*{courseId}">

					<div class="form-group">
						<label>Course Title</label> <input type="text" placeholder="Spring Boot Masterclass"
							th:field="*{title}">
						<small>This will be shown publicly</small>
					</div>
					<div class="form-group">
						<label>Short Description</label>
						<textarea rows="3" placeholder="Learn Spring Boot with real projects"
							th:field="*{description}"></textarea>
					</div>

					<div class="form-group">
						<label>Category</label> <select th:field="*{level}">
							<option th:value="BEGINNER">Beginner</option>
							<option th:value="INTERMEDIATE">Intermediate</option>
							<option th:value="ADVANCED">Advanced</option>
						</select>
					</div>
				</div>

				<!-- PRICING -->
				<div class="card">
					<h3>Pricing</h3>
					<div class="form-group">
						<label>Course Type</label> <select th:field="*{type}" id="courseType">
							<option value="free">Free</option>
							<option value="paid">Paid</option>
						</select>
					</div>

					<div class="form-group" id="priceGroup">
						<label>Price (â‚¹)</label> <input type="number" placeholder="499" th:field="*{price}"
							id="priceInput">
						<small>Only
							required for paid courses</small>
					</div>
				</div>
				<!-- SAVE & CONTINUE (FIRST TIME ONLY) -->
				<button type="submit" name="action" value="draft" class="btn btn-primary"
					th:if="${course.courseId == null}">
					Save & Continue</button>

			</form>
			<!-- CURRICULUM -->

			<div th:if="${course.courseId != null}">

				<div class="card">
					<h3>Curriculum</h3>


					<!-- âœ… WHEN NO MODULES -->
					<div th:if="${#lists.isEmpty(course.modules)}"
						style="padding: 20px; text-align: center; color: #666;">
						<p>No modules yet.</p>
						<p>Start by adding your first module.</p>
					</div>

					<!-- MODULE LOOP -->
					<div th:each="module : ${course.modules}" class="module">

						<!-- UPDATE MODULE -->
						<form th:action="@{/teacher/module/update}" method="post" class="module-header">

							<input type="hidden" name="moduleId" th:value="${module.moduleId}" />

							<input type="text" name="title" th:value="${module.title}" placeholder="Module title" />

							<div class="module-actions">
								<button class="btn btn-outline">Update</button>
							</div>
						</form>

						<!-- DELETE MODULE -->
						<form th:action="@{/teacher/module/delete}" method="post" style="margin-top:8px;">
							<input type="hidden" name="moduleId" th:value="${module.moduleId}" />
							<button class="btn btn-outline">ðŸ—‘ Delete Module</button>
						</form>


						<div class="lessons" th:if="${!#lists.isEmpty(module.lessons)}">
							<div th:each="lesson : ${module.lessons}" class="lesson">
								<span th:text="${lesson.title}"></span>
							</div>
						</div>

						<!-- LESSON LOOP -->
						<div class="lessons" th:if="${!#lists.isEmpty(module.lessons)}">
							<div th:each="lesson : ${module.lessons}" class="lesson">

								<!-- UPDATE LESSON -->
								<form th:action="@{/teacher/lesson/update}" method="post" class="lesson-header">
									<input type="hidden" name="lessonId" th:value="${lesson.lessonId}" />
									<input type="text" name="title" th:value="${lesson.title}" />
									<span th:text="${lesson.type}"></span>
									<button class="btn btn-outline">Update</button>
								</form>

								<!-- DELETE LESSON -->
								<form th:action="@{/teacher/lesson/delete}" method="post">
									<input type="hidden" name="lessonId" th:value="${lesson.lessonId}" />
									<button class="btn btn-outline">ðŸ—‘ Delete Lesson</button>
								</form>

								<form th:if="${lesson.type.name() == 'VIDEO'}"
									th:action="@{/teacher/lesson/video/upload}" method="post"
									enctype="multipart/form-data">
									<input type="hidden" name="lessonId" th:value="${lesson.lessonId}">
									<input type="file" name="video">
									<label><input type="checkbox" name="freePreview"> Free Preview</label>
									<button class="btn btn-outline">Save</button>
								</form>

								<!-- NOTES -->
								<form th:if="${lesson.type.name() == 'NOTES'}"
									th:action="@{/teacher/lesson/notes/upload}" method="post"
									enctype="multipart/form-data">
									<input type="hidden" name="lessonId" th:value="${lesson.lessonId}">
									<input type="file" name="notes">
									<button class="btn btn-outline">Save</button>
								</form>

								<!-- QUIZ -->
								<div th:if="${lesson.type == 'QUIZ'}" class="lesson-content">

									<div th:each="q : ${lesson.questions}" class="quiz-question">
										<input th:value="${q.question}">
										<input th:value="${q.optionA}">
										<input th:value="${q.optionB}">
										<input th:value="${q.optionC}">
										<input th:value="${q.optionD}">
										<select th:value="${q.correct}">
											<option>A</option>
											<option>B</option>
											<option>C</option>
											<option>D</option>
										</select>
									</div>

									<form th:action="@{/teacher/quiz/question/add}" method="post">
										<input type="hidden" name="lessonId" th:value="${lesson.lessonId}">
										<button class="btn btn-outline">+ Add Question</button>
									</form>

								</div>
							</div>
						</div>
						<!-- ADD LESSON -->
						<form th:action="@{/teacher/lesson/add}" method="post" style="margin-top:12px;">
							<input type="hidden" name="moduleId" th:value="${module.moduleId}" />
							<input name="title" placeholder="Lesson title" required />
							<select name="type" required>
								<option value="VIDEO">Video</option>
								<option value="NOTES">Notes</option>
								<option value="QUIZ">Quiz</option>
							</select>
							<button class="btn btn-primary">+ Add Lesson</button>
						</form>


					</div>

					<!-- ADD MODULE -->
					<form th:action="@{/teacher/module/add}" method="post" style="margin-top:20px;">

						<input type="hidden" name="courseId" th:value="${course.courseId}" />

						<input name="title" placeholder="New module title" required />

						<button class="btn btn-primary">
							+ Add Module
						</button>
					</form>

				</div>



				<form th:action="@{/teacher-course/status}" method="post" th:if="${course.courseId != null}">

					<input type="hidden" name="courseId" th:value="${course.courseId}">

					<div class="card publish-card" th:if="${!#lists.isEmpty(course.modules)}">

						<h3>Publish</h3>

						<p>
							Your course will be reviewed before publishing.
							You can save it as a draft anytime.
						</p>

						<button type="submit" name="action" value="publish" class="btn btn-warning">
							Publish Course
						</button>
					</div>

					<div class="action-bar">
						<button type="submit" name="action" value="draft" class="btn btn-outline">
							Save Draft
						</button>

						<button type="submit" name="action" value="next" class="btn btn-primary">
							Next
						</button>
					</div>

				</form>

			</div>

	</main>
</body>

</html>