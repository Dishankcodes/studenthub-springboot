<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Student Dashboard | EduPlatform</title>

	<!-- Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
	<link th:href="@{/css/student-style/student_sidebar.css}" rel="stylesheet">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
		}

		body {
			background: #fff;
			line-height: 1.6;
		}

		.main {
			margin-left: 240px;
			margin-top: 56px;
			padding: 20px;
			transition: 0.3s ease;
		}

		/* ================= LEARNING PAGE ================= */

		.learning-header h2 {
			font-weight: 600;
		}

		.learning-header p {
			color: #6b7280;
			font-size: 0.9rem;
			margin-bottom: 1rem;
		}

		/* Tabs */
		.learning-tabs {
			display: flex;
			gap: 0.5rem;
			margin-bottom: 1.5rem;
		}

		.tab-btn {
			border: none;
			background: #f3f4f6;
			padding: 0.5rem 1rem;
			border-radius: 0.4rem;
			font-size: 0.85rem;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 0.35rem;
		}

		.tab-btn.active {
			background: #2563eb;
			color: #fff;
		}

		/* Tab content */
		.tab-content {
			display: none;
		}

		.tab-content.active {
			display: block;
		}

		/* Completed courses */
		.course-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
			gap: 1rem;
		}

		.course-card {
			background: #fff;
			border: 1px solid #e5e7eb;
			border-radius: 0.6rem;
			padding: 1rem;
		}

		.course-card h4 {
			font-size: 1rem;
			margin-bottom: 0.2rem;
		}

		.course-card .instructor {
			font-size: 0.8rem;
			color: #6b7280;
		}

		.course-meta {
			font-size: 0.75rem;
			margin: 0.6rem 0;
			color: #374151;
		}

		.course-actions a {
			font-size: 0.8rem;
			color: #2563eb;
			text-decoration: none;
			font-weight: 500;
		}

		/* Certificates */
		.certificate-list {
			display: flex;
			flex-direction: column;
			gap: 0.75rem;
		}

		.certificate-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			background: #fff;
			border: 1px solid #e5e7eb;
			border-radius: 0.6rem;
			padding: 0.8rem 1rem;
		}

		.certificate-item h4 {
			font-size: 0.95rem;
		}

		.certificate-item p {
			font-size: 0.75rem;
			color: #6b7280;
		}

		.cert-btn {
			background: #2563eb;
			color: #fff;
			padding: 0.4rem 0.7rem;
			border-radius: 0.4rem;
			font-size: 0.75rem;
			text-decoration: none;
		}
		.course-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1rem;
}

.course-card {
    padding: 14px;
}
/* ===== COURSE CARD ACTIONS UX ===== */
.course-footer .btn {
    padding: 6px 12px;
    border-radius: 8px;
    background: #eef2ff;
    color: #1e3a8a;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s ease;
}

.course-footer .btn:hover {
    background: #2563eb;
    color: #fff;
}

.feedback-btn {
    background: #fef3c7;
    color: #92400e;
}

.feedback-btn:hover {
    background: #f59e0b;
    color: #fff;
}

.feedback-done {
    font-size: 12px;
    color: #16a34a;
    font-weight: 600;
}
	</style>
</head>

<body>

	<!-- ===== SIDEBAR ===== -->
	<div class="sidebar collapsed" id="sidebar">
		<button class="toggle-btn" id="toggle">
			<i class="bi bi-chevron-right"></i>
		</button>

		<div class="sidebar-brand">
			<a href="/student-dashboard">
				<img th:src="@{/images/logo.png}" class="platform-logo" alt="Logo">
			</a>
			<h2 class="platform-name">
				EduPlatform
			</h2>
		</div>

		<a th:href="@{/student-dashboard}"><i class="bi bi-speedometer2"></i><span>Dashboard</span></a>
		<a th:href="@{/student-course}"><i class="bi bi-search"></i><span>Explore Courses</span></a>
		<a th:href="@{/student-learning}" class="active"><i class="bi bi-book-half"></i><span>My Learning</span></a>
		<a th:href="@{/student-feedback}"><i class="bi bi-person-video3"></i><span>Instructor
				Overview</span></a>
		<a th:href="@{/student-news}"><i class="bi bi-megaphone"></i><span>Announcements</span></a>
		<a th:href="@{/student-notes}"><i class="bi bi-graph-up"></i><span>Notes</span></a>
		<a th:href="@{/student-chat}"><i class="bi bi-chat"></i><span>Doubts Chat</span></a>
		<a th:href="@{/student-internships}"><i class="bi bi-briefcase"></i><span>Internships</span></a>
		<a th:href="@{/student-profile}"><i class="bi bi-person-circle"></i><span>Profile</span></a>
		<a th:href="@{/student-login}"><i class="bi bi-box-arrow-right"></i><span>Logout</span></a>

	</div>

	<!-- ===== TOPBAR ===== -->
	<div class="student-topbar">
		<span class="page-title">My Learning</span>
		<div class="topbar-right">
			<div class="notif">
				<a th:href="@{/student-notification}">
					<i class="bi bi-bell"></i>
					<span class="dot"></span> </a>
			</div>

			<div class="profile">
				<a th:href="@{/student-profile}" class="profile-link">
					<img src="/images/default.jpg" alt="Profile">
					<span class="student-name">Dishank</span>
				</a>
			</div>
		</div>

	</div>

	<div class="main">

		<!-- Page Header -->
		<div class="learning-header">
			<h2>My Learning</h2>
			<p>Track your completed courses and download certificates</p>
		</div>

		<!-- Tabs -->
		<div class="learning-tabs">
			<button class="tab-btn active" data-tab="courses">
				<i class="bi bi-check-circle"></i> Completed Courses
			</button>
			<button class="tab-btn" data-tab="certificates">
				<i class="bi bi-award"></i> Certificates
			</button>
		</div>

		<!-- ===== COMPLETED COURSES ===== -->
		<section class="tab-content active" id="courses">

    <div class="course-grid">

        <div class="course-card"
             th:each="course : ${completedCourses}">

            <!-- Thumbnail -->
            <div class="course-thumb" style="height:140px;border-radius:10px;overflow:hidden;">
                <img th:if="${course.thumbnailURL != null}"
                     th:src="${course.thumbnailURL}"
                     style="width:100%;height:100%;object-fit:cover;">

                <div th:if="${course.thumbnailURL == null}"
                     style="height:100%;display:flex;align-items:center;justify-content:center;
                            font-size:36px;background:#f3f4f6;">
                    <i class="bi bi-book"></i>
                </div>
            </div>

            <!-- Content -->
            <div class="course-content">

                <!-- Badge -->
                <span class="course-badge"
                      style="font-size:11px;color:#22c55e;font-weight:600;">
                    <i class="bi bi-check-circle-fill"></i> Completed
                </span>

                <div class="course-title"
                     th:text="${course.title}"
                     style="margin-top:6px;font-weight:600;">
                </div>

                <div class="course-meta"
                     style="font-size:13px;color:#6b7280;">
                    By
                    <span th:text="${course.teacher.firstname + ' ' + course.teacher.lastname}"></span>
                </div>

                <!-- Actions -->
               <!-- Actions -->
<div class="course-footer"
     style="margin-top:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;">

    <!-- View -->
    <a class="btn"
       th:href="@{/student-course-player/{id}(id=${course.courseId})}"
       style="font-size:13px;">
        <i class="bi bi-play-circle"></i> View
    </a>

    <!-- Give Feedback -->
    <a th:if="${!courseFeedbackMap[course.courseId]}"
       th:href="@{/student-feedback/{id}(id=${course.courseId})}"
       class="btn feedback-btn">
        <i class="bi bi-chat-dots-fill"></i> Give Feedback
    </a>

    <!-- Submitted -->
    <span th:if="${courseFeedbackMap[course.courseId]}"
          class="feedback-done">
        <i class="bi bi-check-circle-fill"></i> Feedback submitted
    </span>
</div>
            </div>

        </div>

    </div>

</section>

		<!-- ===== CERTIFICATES ===== -->
		<section class="tab-content" id="certificates">

			<div class="certificate-list">
				<div class="certificate-item" th:each="cert : ${certificates}">
					<div>
						<h4 th:text="${cert.course.title}"></h4>
						<p>
							Issued on <span th:text="${cert.issuedAt}"></span><br>
							<small>Certificate No: <span th:text="${cert.certificateNumber}"></span></small>
						</p>
					</div>

					<a th:href="${cert.pdfPath}" target="_blank" class="cert-btn">
						<i class="bi bi-file-earmark-pdf"></i> Open
					</a>
				</div>
			</div>

		</section>

	</div>


	<!-- ===== SCRIPT ===== -->
	<script>
		const sidebar = document.getElementById("sidebar");
		const toggle = document.getElementById("toggle");
		const icon = toggle.querySelector("i");

		toggle.addEventListener("click", () => {
			if (window.innerWidth <= 768) {
				sidebar.classList.toggle("mobile-show");
			} else {
				sidebar.classList.toggle("collapsed");
				icon.classList.toggle("bi-chevron-right");
				icon.classList.toggle("bi-chevron-left");
			}
		});
	</script>

	<script>
		document.querySelectorAll(".tab-btn").forEach(btn => {
			btn.addEventListener("click", () => {
				document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
				document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));

				btn.classList.add("active");
				document.getElementById(btn.dataset.tab).classList.add("active");
			});
		});
	</script>
</body>

</html>