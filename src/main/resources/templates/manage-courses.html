<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Your Sidebar CSS -->
  <link th:href="@{/css/admin-css/admin_sidebar.css}" rel="stylesheet">
</head>

<body>
<div class="layout">

  <!-- ===== SIDEBAR ===== -->
  <aside class="vertical-sidebar">
    <input type="checkbox" id="sidebar-toggle" class="checkbox-input" checked>
    <nav>
      <header>
        <div class="sidebar__toggle-container">
          <label for="sidebar-toggle" class="nav__toggle" tabindex="0">
            <span class="toggle--icons">
              <i class="bi bi-list toggle--open"></i><i class="bi bi-x-lg toggle--close"></i>
            </span>
          </label>
        </div>
        <figure>
          <img class="codepen-logo" th:src="@{/images/admin-avatar.png}" alt="Admin">
          <figcaption>
            <p class="user-id" th:text="${username}">Admin</p><p class="user-role">Administrator</p>
          </figcaption>
        </figure>
      </header>

      <section class="sidebar__wrapper">
        <ul class="sidebar__list">
          <li class="sidebar__item item--heading">
          <h2 class="sidebar__item--heading">General</h2>
          </li>

          <li class="sidebar__item"><a th:href="@{/admin-dashboard}" >
              <i class="bi bi-speedometer2"></i><span>Dashboard</span></a></li>

          <li class="sidebar__item"><a th:href="@{/manage-students}">
              <i class="bi bi-people"></i><span>Student Management</span></a></li>

          <li class="sidebar__item"><a th:href="@{/manage-teachers}">
              <i class="bi bi-person-badge"></i><span>Instructor Management</span></a></li>

          <li class="sidebar__item"><a th:href="@{/manage-courses}" class="active">
              <i class="bi bi-book"></i><span>Course Management</span></a></li>

          <li class="sidebar__item"><a th:href="@{/manage-internships}">
              <i class="bi bi-briefcase"></i><span>Internship Management</span></a></li>

          <li class="sidebar__item"><a th:href="@{/admin-feedback}">
              <i class="bi bi-bar-chart"></i><span>Feedback</span> </a></li>

          <li class="sidebar__item"><a th:href="@{/admin-settings}">
              <i class="bi bi-gear"></i><span>Settings</span></a></li>

          <li class="sidebar__item"><a th:href="@{/admin-logout}">
              <i class="bi bi-box-arrow-right"></i><span>Logout</span></a></li>
          
        </ul>
      </section>
    </nav>
  </aside>

  <!-- ===== CONTENT AREA ===== -->
  <div class="content-area">
    <!-- ===== TOPBAR ===== -->
    <header class="topbar">
      <span class="page-title"></span>
      <div class="topbar-right">
        <button class="profile-btn dropdown-toggle" data-bs-toggle="dropdown">
          <img th:src="@{/images/admin-avatar.png}" alt="Admin" class="avatar">
          <span th:text="${username}">Admin</span>
        </button>
      </div>
    </header>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="home-section">
      <h1>Manage Courses (Delete & View)</h1>
      <p>Welcome, <span th:text="${username}">Admin</span></p>
      
       <table class="table table-bordered table-striped align-middle mt-3">
    <thead class="table-dark">
    <tr>
        <th>#</th>
        <th>Course Name</th>
        <th>Instructor</th>
        <th>Status</th>
        <th>Type / Price</th>
        <th>Modules / Lessons</th>
        <th>Actions</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="course, stat : ${courses}"  th:id="'course-' + ${course.courseId}">

        <!-- Index -->
        <td th:text="${stat.index + 1}"></td>

        <!-- Course Title -->
        <td th:text="${course.title}"></td>

        <!-- Teacher -->
      <td class="text-nowrap">
    <span class="text-muted">By</span>
    <strong th:text="${course.instructorName}"></strong>
</td>

        <!-- Status -->
        <td>
    <form th:action="@{/manage-course/status/{id}(id=${course.courseId})}"
          method="post"
          class="d-flex gap-1 align-items-center">

        <select name="status" class="form-select form-select-sm">
    <option value="DRAFT" 
        th:selected="${course.status.name() == 'DRAFT'}">Draft</option>
    <option value="PUBLISHED"
        th:selected="${course.status.name() == 'PUBLISHED'}">Published</option>
    <option value="DELETED"
        th:selected="${course.status.name() == 'DELETED'}">Deleted</option>
    <option value="BLOCKED"
        th:selected="${course.status.name() == 'BLOCKED'}">Blocked</option>
</select>

        <button class="btn btn-success btn-sm">
            <i class="bi bi-check"></i>
        </button>
    </form>
</td>

        <!-- Type / Price -->
      <td>
    <span class="fw-semibold text-uppercase"
          th:text="${course.type}"></span>

    <span th:if="${course.type.name() == 'paid'}">
        - â‚¹<span th:text="${course.price}"></span>
    </span>

    <span th:if="${course.type.name() == 'free'}">
        - Free
    </span>
</td>
<td>
    <span class="badge bg-primary"
          th:text="${course.moduleCount + ' Modules'}"></span>
    <br>
    <span class="badge bg-secondary mt-1"
          th:text="${course.lessonCount + ' Lessons'}"></span>
    <br>
    <span class="badge bg-info mt-1"
          th:text="${course.quizCount + ' Quizzes'}"></span>
</td>
        <!-- Actions -->
       <td>
    <!-- View -->
    <a th:href="@{/admin-course/view/{id}(id=${course.courseId})}"
       class="btn btn-info btn-sm"
       title="View Course">
        <i class="bi bi-eye"></i>
    </a>

    <!-- Delete -->
    <form th:action="@{/manage-course/delete/{id}(id=${course.courseId})}"
          method="post"
          class="d-inline"
         onsubmit="return confirm('Mark this course as deleted?');">
        <button type="submit" class="btn btn-danger btn-sm" title="Delete Course">
            <i class="bi bi-trash"></i>
        </button>
    </form>
</td>
    </tr>
    </tbody>
</table>

      
    </main>
  </div>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>